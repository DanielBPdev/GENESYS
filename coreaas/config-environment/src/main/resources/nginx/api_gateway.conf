log_format roles  '$remote_addr - $remote_user [$time_local] "$request" '
'$status $body_bytes_sent "$http_referer" '
'"$http_user_agent" "$http_x_forwarded_for" "$http_permissionsapp"';

server {
    client_header_buffer_size 1k;
    large_client_header_buffers 4 16k;
    listen 8080;
#server_name  genesys-api;
# set client body size to 2M #
    client_max_body_size 5M;
#charset koi8-r;
    error_log /usr/local/nginx/logs/api_gateway_error.log  debug;
#access_log  logs/host.access.log  main;
    location /ReportServer/ {
        if ($request_method = OPTIONS ) {
            add_header 'Access-Control-Allow-Methods' 'GET, POST, DELETE,PUT,OPTIONS' always;
            add_header 'Access-Control-Allow-Headers' 'Content-Type,Authorization,Origin,cache-control,if-modified-since,pragma' always;
            add_header 'Access-Control-Allow-Origin' 'http://10.77.187.5:8080' always;
            add_header 'Access-Control-Expose-Headers' 'Content-Disposition' always;
#add_header 'X-Frame-Options' 'ALLOW-FROM http://10.77.187.5:8080' always;
            add_header 'Content-Length' '0';
            add_header 'Content-Type' 'text/plain';
            return 204;
        }
        proxy_set_header Host $host;
        proxy_pass http://10.77.187.26;
        add_header 'Access-Control-Allow-Methods' 'GET, POST, DELETE,PUT,OPTIONS' always;
        add_header 'Access-Control-Allow-Headers' 'Content-Type,Authorization,Origin,cache-control,if-modified-since,pragma' always;
        add_header 'Access-Control-Expose-Headers' 'Content-Disposition' always;
        add_header 'Access-Control-Allow-Origin' 'http://10.77.187.5:8080' always;
#add_header 'X-Frame-Options' 'ALLOW-FROM http://10.77.187.5:8080' always;
        access_log /usr/local/nginx/logs/proxy-access-comfaboy.log;
    }
    location /comfaboy/ {
        if ($request_method = OPTIONS ) {
            add_header 'Access-Control-Allow-Methods' 'GET, POST, DELETE,PUT,OPTIONS' always;
            add_header 'Access-Control-Allow-Headers' 'Content-Type,Authorization,Origin,cache-control,if-modified-since,pragma,Profile,PermissionsApp' always;
            add_header 'Access-Control-Expose-Headers' 'Content-Disposition,draw,totalrecords' always;
            add_header 'Access-Control-Allow-Origin' 'http://10.77.187.5:8080' always;
            add_header 'Content-Length' '0';
            add_header 'Content-Type' 'text/plain';
            return 204;
        }
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://10.77.187.38/;
		proxy_connect_timeout       300;
        proxy_send_timeout          300;
        proxy_read_timeout          300;
        send_timeout                300;
        add_header 'Access-Control-Allow-Methods' 'GET, POST, DELETE,PUT,OPTIONS' always;
        add_header 'Access-Control-Allow-Headers' 'Content-Type,Authorization,Origin,cache-control,if-modified-since,pragma,Profile,real_ip_header,PermissionsApp' always;
        add_header 'Access-Control-Expose-Headers' 'Content-Disposition,draw,totalrecords' always;
        add_header 'Access-Control-Allow-Origin' 'http://10.77.187.5:8080' always;
        add_header 'real_ip_header' 'X-Originating-IP' always;
        access_log /usr/local/nginx/logs/proxy-access-comfaboy.log;
        access_log /usr/local/nginx/logs/proxy-access-comfaboy-roles.log roles;
    }
    location /comfacauca/ {
        if ($request_method = OPTIONS ) {
            add_header 'Access-Control-Allow-Methods' 'GET, POST, DELETE,PUT,OPTIONS' always;
            add_header 'Access-Control-Allow-Headers' 'Content-Type,Authorization,Origin,cache-control,if-modified-since,pragma,Profile,PermissionsApp' always;
            add_header 'Access-Control-Expose-Headers' 'Content-Disposition,draw,totalrecords' always;
            add_header 'Access-Control-Allow-Origin' 'http://10.77.187.5:8080' always;
            add_header 'Content-Length' '0';
            add_header 'Content-Type' 'text/plain';
            return 204;
        }
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://10.77.187.51:8181/;
        proxy_connect_timeout 300;
        proxy_send_timeout 300;
        proxy_read_timeout 300;
        send_timeout 300;
        add_header 'Access-Control-Allow-Methods' 'GET, POST, DELETE,PUT,OPTIONS' always;
        add_header 'Access-Control-Allow-Headers' 'Content-Type,Authorization,Origin,cache-control,if-modified-since,pragma,Profile,PermissionsApp' always;
        add_header 'Access-Control-Expose-Headers' 'Content-Disposition,draw,totalrecords' always;
        add_header 'Access-Control-Allow-Origin' 'http://10.77.187.5:8080' always;
        access_log /usr/local/nginx/logs/proxy-access-comfacauca.log;
        access_log /usr/local/nginx/logs/proxy-access-comfacauca-roles.log roles;
    }
    location /confa/ {
        if ($request_method = OPTIONS ) {
            add_header 'Access-Control-Allow-Methods' 'GET, POST, DELETE,PUT,OPTIONS' always;
            add_header 'Access-Control-Allow-Headers' 'Content-Type,Authorization,Origin,cache-control,if-modified-since,pragma,PermissionsApp' always;
            add_header 'Access-Control-Allow-Origin' 'http://genesys.heinsohn.com.co:8080' always;
            add_header 'Access-Control-Expose-Headers' 'Content-Disposition' always;
            add_header 'Content-Length' '0';
            add_header 'Content-Type' 'text/plain';
            return 204;
        }
        proxy_set_header Host $host;
        proxy_pass http://10.77.187.3:8181/;
        add_header 'Access-Control-Allow-Methods' 'GET, POST, DELETE,PUT,OPTIONS' always;
        add_header 'Access-Control-Allow-Headers' 'Content-Type,Authorization,Origin,cache-control,if-modified-since,pragma,PermissionsApp' always;
        add_header 'Access-Control-Expose-Headers' 'Content-Disposition' always;
        add_header 'Access-Control-Allow-Origin' 'http://10.77.187.9:8080' always;
        access_log /usr/local/nginx/logs/proxy-access-confa.log;
    }
    location /confaintegracion/ {
        if ($request_method = OPTIONS ) {
            add_header 'Access-Control-Allow-Methods' 'GET, POST, DELETE,PUT,OPTIONS' always;
            add_header 'Access-Control-Allow-Headers' 'Content-Type,Authorization,Origin,cache-control,if-modified-since,pragma,Profile,PermissionsApp' always;
            add_header 'Access-Control-Expose-Headers' 'Content-Disposition,draw,totalrecords' always;
            add_header 'Access-Control-Allow-Origin' 'http://10.77.187.9:8080' always;
            add_header 'Content-Length' '0';
            add_header 'Content-Type' 'text/plain';
            return 204;
        }
        proxy_set_header Host $host;
		proxy_set_header X-Real-IP $remote_addr;
		proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://10.77.187.13:8181/;
        proxy_connect_timeout 300;
        proxy_send_timeout 300;
        proxy_read_timeout 300;
        send_timeout 300;
        add_header 'Access-Control-Allow-Methods' 'GET, POST, DELETE,PUT,OPTIONS' always;
        add_header 'Access-Control-Allow-Headers' 'Content-Type,Authorization,Origin,cache-control,if-modified-since,pragma,Profile,PermissionsApp' always;
        add_header 'Access-Control-Expose-Headers' 'Content-Disposition,draw,totalrecords' always;
        add_header 'Access-Control-Allow-Origin' 'http://10.77.187.9:8080' always;
        access_log /usr/local/nginx/logs/proxy-access-confa.log;
    }
    location /subsidio/ {
        if ($request_method = OPTIONS ) {
            add_header 'Access-Control-Allow-Methods' 'GET, POST, DELETE,PUT,OPTIONS' always;
            add_header 'Access-Control-Allow-Headers' 'Content-Type,Authorization,Origin,cache-control,if-modified-since,pragma,Profile,PermissionsApp' always;
            add_header 'Access-Control-Expose-Headers' 'Content-Disposition,draw,totalrecords' always;
            add_header 'Access-Control-Allow-Origin' 'http://172.20.0.135:8080' always;
            add_header 'Content-Length' '0';
            add_header 'Content-Type' 'text/plain';
            return 204;
        }
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://172.20.0.135:8181/;
        proxy_connect_timeout 300;
        proxy_send_timeout 300;
        proxy_read_timeout 300;
        send_timeout 300;
        add_header 'Access-Control-Allow-Methods' 'GET, POST, DELETE,PUT,OPTIONS' always;
        add_header 'Access-Control-Allow-Headers' 'Content-Type,Authorization,Origin,cache-control,if-modified-since,pragma,Profile,PermissionsApp' always;
        add_header 'Access-Control-Expose-Headers' 'Content-Disposition,draw,totalrecords' always;
        add_header 'Access-Control-Allow-Origin' 'http://172.20.0.135:8080' always;
        access_log /usr/local/nginx/logs/proxy-access-subsidio.log;
    }
    location /funcional/ {
        if ($request_method = OPTIONS ) {
            add_header 'Access-Control-Allow-Methods' 'GET, POST, DELETE,PUT,OPTIONS' always;
            add_header 'Access-Control-Allow-Headers' 'Content-Type,Authorization,Origin,cache-control,if-modified-since,pragma,Profile,PermissionsApp' always;
            add_header 'Access-Control-Expose-Headers' 'Content-Disposition,draw,totalrecords' always;
            add_header 'Access-Control-Allow-Origin' 'http://genesys_hbt.heinsohn.com.co:8080' always;
            add_header 'Content-Length' '0';
            add_header 'Content-Type' 'text/plain';
            return 204;
        }
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://10.77.187.13:8181/;
        proxy_connect_timeout 300;
        proxy_send_timeout 300;
        proxy_read_timeout 300;
        send_timeout 300;
        add_header 'Access-Control-Allow-Methods' 'GET, POST, DELETE,PUT,OPTIONS' always;
        add_header 'Access-Control-Allow-Headers' 'Content-Type,Authorization,Origin,cache-control,if-modified-since,pragma,Profile,PermissionsApp' always;
        add_header 'Access-Control-Expose-Headers' 'Content-Disposition,draw,totalrecords' always;
        add_header 'Access-Control-Allow-Origin' 'http://genesys_hbt.heinsohn.com.co:8080' always;
        access_log /usr/local/nginx/logs/proxy-access-funcional.log;
    }
}
